## ADDED Requirements

### Requirement: 交易紀錄結構
每筆交易 SHALL 包含：日期、客戶、趟次編號、車號、司機、品項明細、總金額。

#### Scenario: 檢視交易紀錄
- **WHEN** 使用者開啟交易紀錄
- **THEN** 系統顯示完整交易資訊

### Requirement: 新增交易品項
系統 SHALL 允許在交易中新增多個品項，每個品項包含：品名、數量、單價、小計。

#### Scenario: 新增品項
- **WHEN** 使用者輸入品名與數量
- **THEN** 系統檢查是否有合約價並自動帶入或要求手動輸入

### Requirement: 價格自動帶入
系統 SHALL 在輸入品項時檢查客戶合約，若有合約價則自動帶入。

#### Scenario: 使用合約價
- **WHEN** 品項名稱符合有效合約內的品項
- **THEN** 系統自動帶入合約價格並標示「合約價」

#### Scenario: 使用浮動價
- **WHEN** 品項名稱不在合約內或無合約
- **THEN** 系統要求使用者手動輸入價格並標示「浮動價」

### Requirement: 正負金額處理
系統 SHALL 支援正數（客戶付費）與負數（公司付費）金額。

#### Scenario: 客戶付費項目
- **WHEN** 單價為正數
- **THEN** 該項目計入應收金額

#### Scenario: 公司付費項目
- **WHEN** 單價為負數
- **THEN** 該項目計入應付金額

### Requirement: 編輯交易紀錄
系統 SHALL 允許編輯未結算的交易紀錄。

#### Scenario: 編輯品項數量
- **WHEN** 使用者修改品項數量
- **THEN** 系統重新計算小計與總金額

### Requirement: 查詢交易紀錄
系統 SHALL 提供交易紀錄查詢功能，支援依客戶、日期範圍、狀態篩選。

#### Scenario: 依客戶查詢
- **WHEN** 使用者選擇特定客戶
- **THEN** 系統顯示該客戶所有交易紀錄
